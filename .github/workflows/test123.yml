name: learn-github-actions
run-name: ${{ github.actor }} is learning GitHub Actions
on:
  push:
    branches:
      - release/*
env:
  FREE_USER_EMAIL: ""
jobs:
  generate-env-file:
    runs-on: self-hosted
    steps:
      - name: Generate email address
        id: generate-email
        run: |
          FREE_USER_EMAIL="cypress+ci+$(openssl rand -hex 4)@gmail.com"
          echo "Generated email: $FREE_USER_EMAIL"
          echo "FREE_USER_EMAIL=$FREE_USER_EMAIL" >> $GITHUB_ENV
      - name: Use email address
        run: |
          echo "Using email: $FREE_USER_EMAIL"
      - name: create-json
        id: create-json
        uses: jsdaniell/create-json@v1.2.2
        with:
          name: "cypress.env.json"
          json: '"userFree":{{"email": "${{ env.FREE_USER_EMAIL }}", "password":"123456"}}'
          dir: "."
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - name: Print cypress.ev.json
        run: |
          cat cypress.env.json
        working-directory: ${{ github.workspace }}

      - name: Test JSON file creation
        run: |
          if [ -f "file.json" ]; then
            echo "File created successfully"
            cat file.json
            cat credentials.json
          else
            echo "File creation failed"
          fi
        working-directory: .
